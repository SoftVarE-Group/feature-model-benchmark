# vul_description: The JSSubScriptLoader in Mozilla Firefox 4.x through 6 and SeaMonkey before 2.4 does not properly handle XPCNativeWrappers during calls to the loadSubScript method in an add_on, which makes it easier for remote attackers to gain privileges via a crafted web site that leverages certain unwrapping behavior.

%Relationships 
CVE_2011_3004: types sources exploits mozilla;

types: application;
sources: nvd;

exploits: [direct] [indirect];
mozilla: [1,1] {mozilla_firefox mozilla_seamonkey};

mozilla_firefox: mozilla_firefox_version mozilla_firefox_update;
mozilla_seamonkey: mozilla_seamonkey_version mozilla_seamonkey_update;

mozilla_firefox_version: [1,1] {mozilla_firefox_version_6__0 mozilla_firefox_version_5__0 mozilla_firefox_version_4__0__1 mozilla_firefox_version_4__0};
mozilla_firefox_update: [1,1] {mozilla_firefox_update_beta2 mozilla_firefox_update_beta3 mozilla_firefox_update_beta6 mozilla_firefox_update_beta8 mozilla_firefox_update_beta12 mozilla_firefox_update_beta5 mozilla_firefox_update_beta4 mozilla_firefox_update_beta7 mozilla_firefox_update_beta1 mozilla_firefox_update_beta9 mozilla_firefox_update_beta11 mozilla_firefox_update_beta10 mozilla_firefox_update_any};
mozilla_seamonkey_version: [1,1] {mozilla_seamonkey_version_1__1__3 mozilla_seamonkey_version_2__0__10 mozilla_seamonkey_version_1__1__7 mozilla_seamonkey_version_2__0 mozilla_seamonkey_version_1__1__10 mozilla_seamonkey_version_1__0__2 mozilla_seamonkey_version_1__1 mozilla_seamonkey_version_1__1__8 mozilla_seamonkey_version_1__1__2 mozilla_seamonkey_version_2__0__1 mozilla_seamonkey_version_2__0__11 mozilla_seamonkey_version_2__0__13 mozilla_seamonkey_version_1__0__5 mozilla_seamonkey_version_2__0__14 mozilla_seamonkey_version_1__5__0__8 mozilla_seamonkey_version_2__0__6 mozilla_seamonkey_version_2__0__12 mozilla_seamonkey_version_2__0__3 mozilla_seamonkey_version_1__0__1 mozilla_seamonkey_version_1__1__9 mozilla_seamonkey_version_1__0__6 mozilla_seamonkey_version_2__3__1 mozilla_seamonkey_version_2__1 mozilla_seamonkey_version_1__0__3 mozilla_seamonkey_version_2__2 mozilla_seamonkey_version_1__1__13 mozilla_seamonkey_version_2__0__9 mozilla_seamonkey_version_2__0a1pre mozilla_seamonkey_version_1__1__14 mozilla_seamonkey_version_any mozilla_seamonkey_version_1__0__7 mozilla_seamonkey_version_1__1__17 mozilla_seamonkey_version_1__1__4 mozilla_seamonkey_version_1__0__9 mozilla_seamonkey_version_1__1__5 mozilla_seamonkey_version_2__0__8 mozilla_seamonkey_version_1__0 mozilla_seamonkey_version_1__0__4 mozilla_seamonkey_version_1__5__0__9 mozilla_seamonkey_version_1__1__18 mozilla_seamonkey_version_1__0__8 mozilla_seamonkey_version_1__1__15 mozilla_seamonkey_version_1__1__19 mozilla_seamonkey_version_2__3 mozilla_seamonkey_version_1__0__99 mozilla_seamonkey_version_2__3__2 mozilla_seamonkey_version_2__0__2 mozilla_seamonkey_version_1__1__12 mozilla_seamonkey_version_1__5__0__10 mozilla_seamonkey_version_1__1__16 mozilla_seamonkey_version_2__0__4 mozilla_seamonkey_version_2__0__5 mozilla_seamonkey_version_1__1__11 mozilla_seamonkey_version_1__1__1 mozilla_seamonkey_version_2__0a1 mozilla_seamonkey_version_1__1__6 mozilla_seamonkey_version_2__0__7 mozilla_seamonkey_version_2__3__3};
mozilla_seamonkey_update: [1,1] {mozilla_seamonkey_update_beta2 mozilla_seamonkey_update_alpha__3 mozilla_seamonkey_update_beta3 mozilla_seamonkey_update_rc1 mozilla_seamonkey_update_alpha2 mozilla_seamonkey_update_alpha3 mozilla_seamonkey_update_1__1__10 mozilla_seamonkey_update_alpha1 mozilla_seamonkey_update_beta mozilla_seamonkey_update_alpha__1 mozilla_seamonkey_update_rc2 mozilla_seamonkey_update_beta__1 mozilla_seamonkey_update_beta1 mozilla_seamonkey_update_beta__2 mozilla_seamonkey_update_alpha mozilla_seamonkey_update_alpha__2 mozilla_seamonkey_update_any};



%Constraints 
mozilla_firefox REQUIRES application;
mozilla_seamonkey REQUIRES application;
mozilla_firefox_update_beta2 REQUIRES mozilla_firefox_version_4__0;
mozilla_firefox_update_beta3 REQUIRES mozilla_firefox_version_4__0;
mozilla_firefox_update_beta6 REQUIRES mozilla_firefox_version_4__0;
mozilla_firefox_update_beta8 REQUIRES mozilla_firefox_version_4__0;
mozilla_firefox_update_beta12 REQUIRES mozilla_firefox_version_4__0;
mozilla_firefox_update_beta5 REQUIRES mozilla_firefox_version_4__0;
mozilla_firefox_update_beta4 REQUIRES mozilla_firefox_version_4__0;
mozilla_firefox_update_beta7 REQUIRES mozilla_firefox_version_4__0;
mozilla_firefox_update_beta1 REQUIRES mozilla_firefox_version_4__0;
mozilla_firefox_update_beta9 REQUIRES mozilla_firefox_version_4__0;
mozilla_firefox_update_beta11 REQUIRES mozilla_firefox_version_4__0;
mozilla_firefox_update_beta10 REQUIRES mozilla_firefox_version_4__0;
mozilla_seamonkey_version_1__1__3 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_2__0__10 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_1__1__7 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_2__0 IMPLIES ((mozilla_seamonkey_update_alpha__3 AND NOT mozilla_seamonkey_update_rc1 AND NOT mozilla_seamonkey_update_alpha__1 AND NOT mozilla_seamonkey_update_rc2 AND NOT mozilla_seamonkey_update_beta__1 AND NOT mozilla_seamonkey_update_beta__2 AND NOT mozilla_seamonkey_update_alpha__2 AND NOT mozilla_seamonkey_update_any) OR (NOT mozilla_seamonkey_update_alpha__3 AND mozilla_seamonkey_update_rc1 AND NOT mozilla_seamonkey_update_alpha__1 AND NOT mozilla_seamonkey_update_rc2 AND NOT mozilla_seamonkey_update_beta__1 AND NOT mozilla_seamonkey_update_beta__2 AND NOT mozilla_seamonkey_update_alpha__2 AND NOT mozilla_seamonkey_update_any) OR (NOT mozilla_seamonkey_update_alpha__3 AND NOT mozilla_seamonkey_update_rc1 AND mozilla_seamonkey_update_alpha__1 AND NOT mozilla_seamonkey_update_rc2 AND NOT mozilla_seamonkey_update_beta__1 AND NOT mozilla_seamonkey_update_beta__2 AND NOT mozilla_seamonkey_update_alpha__2 AND NOT mozilla_seamonkey_update_any) OR (NOT mozilla_seamonkey_update_alpha__3 AND NOT mozilla_seamonkey_update_rc1 AND NOT mozilla_seamonkey_update_alpha__1 AND mozilla_seamonkey_update_rc2 AND NOT mozilla_seamonkey_update_beta__1 AND NOT mozilla_seamonkey_update_beta__2 AND NOT mozilla_seamonkey_update_alpha__2 AND NOT mozilla_seamonkey_update_any) OR (NOT mozilla_seamonkey_update_alpha__3 AND NOT mozilla_seamonkey_update_rc1 AND NOT mozilla_seamonkey_update_alpha__1 AND NOT mozilla_seamonkey_update_rc2 AND mozilla_seamonkey_update_beta__1 AND NOT mozilla_seamonkey_update_beta__2 AND NOT mozilla_seamonkey_update_alpha__2 AND NOT mozilla_seamonkey_update_any) OR (NOT mozilla_seamonkey_update_alpha__3 AND NOT mozilla_seamonkey_update_rc1 AND NOT mozilla_seamonkey_update_alpha__1 AND NOT mozilla_seamonkey_update_rc2 AND NOT mozilla_seamonkey_update_beta__1 AND mozilla_seamonkey_update_beta__2 AND NOT mozilla_seamonkey_update_alpha__2 AND NOT mozilla_seamonkey_update_any) OR (NOT mozilla_seamonkey_update_alpha__3 AND NOT mozilla_seamonkey_update_rc1 AND NOT mozilla_seamonkey_update_alpha__1 AND NOT mozilla_seamonkey_update_rc2 AND NOT mozilla_seamonkey_update_beta__1 AND NOT mozilla_seamonkey_update_beta__2 AND mozilla_seamonkey_update_alpha__2 AND NOT mozilla_seamonkey_update_any) OR (NOT mozilla_seamonkey_update_alpha__3 AND NOT mozilla_seamonkey_update_rc1 AND NOT mozilla_seamonkey_update_alpha__1 AND NOT mozilla_seamonkey_update_rc2 AND NOT mozilla_seamonkey_update_beta__1 AND NOT mozilla_seamonkey_update_beta__2 AND NOT mozilla_seamonkey_update_alpha__2 AND mozilla_seamonkey_update_any));
mozilla_seamonkey_version_1__1__10 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_1__0__2 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_1__1 IMPLIES ((mozilla_seamonkey_update_beta AND NOT mozilla_seamonkey_update_alpha AND NOT mozilla_seamonkey_update_any) OR (NOT mozilla_seamonkey_update_beta AND mozilla_seamonkey_update_alpha AND NOT mozilla_seamonkey_update_any) OR (NOT mozilla_seamonkey_update_beta AND NOT mozilla_seamonkey_update_alpha AND mozilla_seamonkey_update_any));
mozilla_seamonkey_version_1__1__8 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_1__1__2 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_2__0__1 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_2__0__11 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_2__0__13 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_1__0__5 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_2__0__14 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_1__5__0__8 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_2__0__6 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_2__0__12 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_2__0__3 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_1__0__1 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_1__1__9 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_1__0__6 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_2__3__1 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_2__1 IMPLIES ((mozilla_seamonkey_update_beta2 AND NOT mozilla_seamonkey_update_beta3 AND NOT mozilla_seamonkey_update_rc1 AND NOT mozilla_seamonkey_update_alpha2 AND NOT mozilla_seamonkey_update_alpha3 AND NOT mozilla_seamonkey_update_alpha1 AND NOT mozilla_seamonkey_update_rc2 AND NOT mozilla_seamonkey_update_beta1 AND NOT mozilla_seamonkey_update_any) OR (NOT mozilla_seamonkey_update_beta2 AND mozilla_seamonkey_update_beta3 AND NOT mozilla_seamonkey_update_rc1 AND NOT mozilla_seamonkey_update_alpha2 AND NOT mozilla_seamonkey_update_alpha3 AND NOT mozilla_seamonkey_update_alpha1 AND NOT mozilla_seamonkey_update_rc2 AND NOT mozilla_seamonkey_update_beta1 AND NOT mozilla_seamonkey_update_any) OR (NOT mozilla_seamonkey_update_beta2 AND NOT mozilla_seamonkey_update_beta3 AND mozilla_seamonkey_update_rc1 AND NOT mozilla_seamonkey_update_alpha2 AND NOT mozilla_seamonkey_update_alpha3 AND NOT mozilla_seamonkey_update_alpha1 AND NOT mozilla_seamonkey_update_rc2 AND NOT mozilla_seamonkey_update_beta1 AND NOT mozilla_seamonkey_update_any) OR (NOT mozilla_seamonkey_update_beta2 AND NOT mozilla_seamonkey_update_beta3 AND NOT mozilla_seamonkey_update_rc1 AND mozilla_seamonkey_update_alpha2 AND NOT mozilla_seamonkey_update_alpha3 AND NOT mozilla_seamonkey_update_alpha1 AND NOT mozilla_seamonkey_update_rc2 AND NOT mozilla_seamonkey_update_beta1 AND NOT mozilla_seamonkey_update_any) OR (NOT mozilla_seamonkey_update_beta2 AND NOT mozilla_seamonkey_update_beta3 AND NOT mozilla_seamonkey_update_rc1 AND NOT mozilla_seamonkey_update_alpha2 AND mozilla_seamonkey_update_alpha3 AND NOT mozilla_seamonkey_update_alpha1 AND NOT mozilla_seamonkey_update_rc2 AND NOT mozilla_seamonkey_update_beta1 AND NOT mozilla_seamonkey_update_any) OR (NOT mozilla_seamonkey_update_beta2 AND NOT mozilla_seamonkey_update_beta3 AND NOT mozilla_seamonkey_update_rc1 AND NOT mozilla_seamonkey_update_alpha2 AND NOT mozilla_seamonkey_update_alpha3 AND mozilla_seamonkey_update_alpha1 AND NOT mozilla_seamonkey_update_rc2 AND NOT mozilla_seamonkey_update_beta1 AND NOT mozilla_seamonkey_update_any) OR (NOT mozilla_seamonkey_update_beta2 AND NOT mozilla_seamonkey_update_beta3 AND NOT mozilla_seamonkey_update_rc1 AND NOT mozilla_seamonkey_update_alpha2 AND NOT mozilla_seamonkey_update_alpha3 AND NOT mozilla_seamonkey_update_alpha1 AND mozilla_seamonkey_update_rc2 AND NOT mozilla_seamonkey_update_beta1 AND NOT mozilla_seamonkey_update_any) OR (NOT mozilla_seamonkey_update_beta2 AND NOT mozilla_seamonkey_update_beta3 AND NOT mozilla_seamonkey_update_rc1 AND NOT mozilla_seamonkey_update_alpha2 AND NOT mozilla_seamonkey_update_alpha3 AND NOT mozilla_seamonkey_update_alpha1 AND NOT mozilla_seamonkey_update_rc2 AND mozilla_seamonkey_update_beta1 AND NOT mozilla_seamonkey_update_any) OR (NOT mozilla_seamonkey_update_beta2 AND NOT mozilla_seamonkey_update_beta3 AND NOT mozilla_seamonkey_update_rc1 AND NOT mozilla_seamonkey_update_alpha2 AND NOT mozilla_seamonkey_update_alpha3 AND NOT mozilla_seamonkey_update_alpha1 AND NOT mozilla_seamonkey_update_rc2 AND NOT mozilla_seamonkey_update_beta1 AND mozilla_seamonkey_update_any));
mozilla_seamonkey_version_1__0__3 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_2__2 IMPLIES ((mozilla_seamonkey_update_beta2 AND NOT mozilla_seamonkey_update_beta3 AND NOT mozilla_seamonkey_update_beta1 AND NOT mozilla_seamonkey_update_any) OR (NOT mozilla_seamonkey_update_beta2 AND mozilla_seamonkey_update_beta3 AND NOT mozilla_seamonkey_update_beta1 AND NOT mozilla_seamonkey_update_any) OR (NOT mozilla_seamonkey_update_beta2 AND NOT mozilla_seamonkey_update_beta3 AND mozilla_seamonkey_update_beta1 AND NOT mozilla_seamonkey_update_any) OR (NOT mozilla_seamonkey_update_beta2 AND NOT mozilla_seamonkey_update_beta3 AND NOT mozilla_seamonkey_update_beta1 AND mozilla_seamonkey_update_any));
mozilla_seamonkey_version_1__1__13 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_2__0__9 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_2__0a1pre REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_1__1__14 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_any REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_1__0__7 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_1__1__17 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_1__1__4 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_1__0__9 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_1__1__5 IMPLIES ((mozilla_seamonkey_update_1__1__10 AND NOT mozilla_seamonkey_update_any) OR (NOT mozilla_seamonkey_update_1__1__10 AND mozilla_seamonkey_update_any));
mozilla_seamonkey_version_2__0__8 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_1__0 IMPLIES ((mozilla_seamonkey_update_beta AND NOT mozilla_seamonkey_update_alpha AND NOT mozilla_seamonkey_update_any) OR (NOT mozilla_seamonkey_update_beta AND mozilla_seamonkey_update_alpha AND NOT mozilla_seamonkey_update_any) OR (NOT mozilla_seamonkey_update_beta AND NOT mozilla_seamonkey_update_alpha AND mozilla_seamonkey_update_any));
mozilla_seamonkey_version_1__0__4 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_1__5__0__9 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_1__1__18 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_1__0__8 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_1__1__15 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_1__1__19 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_2__3 IMPLIES ((mozilla_seamonkey_update_beta2 AND NOT mozilla_seamonkey_update_beta3 AND NOT mozilla_seamonkey_update_beta1 AND NOT mozilla_seamonkey_update_any) OR (NOT mozilla_seamonkey_update_beta2 AND mozilla_seamonkey_update_beta3 AND NOT mozilla_seamonkey_update_beta1 AND NOT mozilla_seamonkey_update_any) OR (NOT mozilla_seamonkey_update_beta2 AND NOT mozilla_seamonkey_update_beta3 AND mozilla_seamonkey_update_beta1 AND NOT mozilla_seamonkey_update_any) OR (NOT mozilla_seamonkey_update_beta2 AND NOT mozilla_seamonkey_update_beta3 AND NOT mozilla_seamonkey_update_beta1 AND mozilla_seamonkey_update_any));
mozilla_seamonkey_version_1__0__99 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_2__3__2 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_2__0__2 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_1__1__12 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_1__5__0__10 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_1__1__16 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_2__0__4 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_2__0__5 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_1__1__11 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_1__1__1 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_2__0a1 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_1__1__6 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_2__0__7 REQUIRES mozilla_seamonkey_update_any;
mozilla_seamonkey_version_2__3__3 REQUIRES mozilla_seamonkey_update_any;
